--comentarios con dos guiones 

/* comentario 
SQL - Lenguaje de consulta estructurado (structured query lenguaje)
*/

-- base de datos - conjunto de datos organizados entre si, almacenados 
-- en tablas 

/* La estructura de las tablas sería de la siguiente manera 
Llave primaria -- Id 
Llave foranea -- llave primaria que proviene de otra tabla 

-- ALUMNO
-- MATRICULA O ID
-- NOMBRE 
-- FECHA DE NACIMIENTO 
-- SEXO 
-- GRADO 
-- STATUS DE ACTIVO O INACTIVO
-- CURP

*/

-- Creando la tabla de alumno
-- sintaxis puede ir en mayuscula o minusculas


CREATE TABLE alumno (
ID_alumno number primary key, -- comenzamos con su llave primaria 
nombre nvarchar2 (30), -- indicamos otro dato y tipo de dato
fecha date, 
sexo nvarchar2 (10),
curp nvarchar2 (18),
grado nvarchar2 (8),
status number);

--si quiero ver la estructura de una tabla se usa describe y nombre de tabla

describe alumno;

-- crear una tabla con la carrera de los alumnos

create table carreras(
id_carrera number primary key,
nombre nvarchar2(30),
area nvarchar2(30),
num_semestres number,
nun_materias number,
creditos number);

describe carreras

create table carreras_alumnos(
id_carreras_alumnos number primary key,
id_carrera number,
id_alumno number);

describe carreras_alumnos


-- entidades fuertes
-- son aquellas que tienen sus datos completos y no dependen 
-- de otra entidad o tabla para existir 


-- entidades debiles
-- son aquellas que reciben una llave foreana y esto las hace dependientes 
-- de otras tablas para existir 

-- agragando restricciones a una tabla 
-- restricciones llevan nombre y id 
-- comando "Constraint"
/*en la tabla alumnos vamos a agregar una restriccion en el sexo
por ejemplo solo introducir si el sexo es de tipo "Masculino" o "Femenino"
*/


alter table alumno add constraint check_sexo check(
sexo in ('masculino','femenino'));

describe alumno

/*  
UNIQUE se usa para agregar una restriccion unica en un registro*/

alter table carreras add constraint unq_nombre_carrera
unique(nombre);


/*agregando una llave foranea, especificamos de donde proviene dicha llave*/

alter table carreras_alumnos add constraint fk_id_alumno
foreign key(id_alumno) --quien recibe 
references alumno (id_alumno); --quien da (de que tabla)


alter table carreras_alumnos add constraint fk_id_carrera
foreign key(id_carrera) --quien recibe 
references carreras (id_carrera); --quien da (de que tabla)

describe carreras;
insert into alumno values
(1,'aylin',to_date('10-02-19', 'YYYY-MM-DD'),'femenino','asd23123','8stre',1);
insert into alumno values
(2,'alex','19/04/1996','masculino','a12awqas3','8stre',1);
insert into alumno values
(3,'alejandro','19/04/1997','masculino','asdqwe12a23123','8 stre',1);
insert into alumno values
(4,'abdiel','19/04/1998','femenino','asda12a23qwe23','8 stre',1);
insert into alumno values
(5,'marcos','19/04/1999','masculino','asda12a23qwe23','8 stre',1);
insert into alumno values
(6,'eduardo','19/04/2000','masculino','asda12qwrqra23123','8 stre',1);
insert into alumno values
(7,'tavo','19/04/1955','masculino','asda12a2312wr3','8 stre',1);
insert into alumno values
(8,'aemanuel','19/04/1965','femenino','asda12a23rwq123','8stre',1);
insert into alumno values
(9,'aaron','19/04/1955','masculino','asda12a2312rw3','8 stre',1);
insert into alumno values
(10,'cesar','19/04/1795','masculino','asda12a231rqw23','8 stre',1);


-- commit para guardar

describe carreras_alumnos;
--insercion de datos en la tabla relacional carreras_alumnos
insert into carreras_alumnos values(1,1,1);
insert into carreras_alumnos values(2,2,2);
insert into carreras_alumnos values(3,1,3);
insert into carreras_alumnos values(4,5,4);
insert into carreras_alumnos values(5,3,5);

select * from carreras_alumnos;

-- agregar una columna a ua tabla existente 
alter table carreras add presupuesto_anual number (5,2);
-- aqui se crearan 5 numeros con de a dos decimales
-- tendriamos valores del -999.99 al 999.99

DESCRIBE CARRERAS;

-- MODIFICAR TIPO DE DATO DE LA COLUMNA (SIEMPRE Y CUANDO NO TENGA
-- DATOS INSERTADOS)

ALTER TABLE CARRERAS MODIFY PRESUPUESTO_ANUAL NVARCHAR2(10);

-- RENOMBRAR UNA COLUMNA
ALTER TABLE CARRERAS RENAME COLUMN PRESUPUESTO_ANUAL TO PRESUPUESTO_MENSUAL;

-- EJERCICIO
-- CREAR UNA TABLA QUE SE LLAME TUTORES
-- ID DEL TUTOR  - PRIMARY KEY , NOMBRE DEL TUTOR, CLAVE DEL TUTOR
-- PONERLE RESTRICCION A LA CLAVE DEL TUTOR (A,B,C,D)
-- INSERTAR 10 REGISTROS

-- CREAR UNA TABLA RELACIONAL ALUMNOS_TUTORES
-- ID DE LA TABLA - PRIMARY KEY
-- ID ALUMNO
-- ID TUTOR
-- INSERTAR 5 REGISTROS

CREATE TABLE TUTORES(
ID_TUTOR NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
CLAVE NVARCHAR2(1),
CONSTRAINT CHECK_CLAVE CHECK 
(CLAVE IN ('A','B','C','D'))
);

CREATE TABLE ALUMNOS_TUTORES(
ID_AT NUMBER PRIMARY KEY,
ID_ALUMNO NUMBER,
ID_TUTOR NUMBER,
CONSTRAINT FK_IDALUMNO
FOREIGN KEY (ID_ALUMNO)
REFERENCES ALUMNO (ID_ALUMNO),
CONSTRAINT FK_IDTUTOR
FOREIGN KEY (ID_TUTOR)
REFERENCES TUTORES (ID_TUTOR)
);

INSERT INTO TUTORES VALUES (1,'FILOMENO','A');
INSERT INTO TUTORES VALUES (2,'PANFILO','B');
INSERT INTO TUTORES VALUES (3,'EUSTAQUIO','C');
INSERT INTO TUTORES VALUES (4,'EUSEBIO','D');
INSERT INTO TUTORES VALUES (5,'ARNULFO','A');
INSERT INTO TUTORES VALUES (6,'FITO','B');
INSERT INTO TUTORES VALUES (7,'CASIMIRO','C');
INSERT INTO TUTORES VALUES (8,'RAMIRO','D');
INSERT INTO TUTORES VALUES (9,'TEOFILO','A');
INSERT INTO TUTORES VALUES (10,'HERMELINDA','D');

INSERT INTO ALUMNOS_TUTORES VALUES (1,1,1);
INSERT INTO ALUMNOS_TUTORES VALUES (2,2,2);
INSERT INTO ALUMNOS_TUTORES VALUES (3,3,3);
INSERT INTO ALUMNOS_TUTORES VALUES (4,4,4);
INSERT INTO ALUMNOS_TUTORES VALUES (5,5,5);
INSERT INTO ALUMNOS_TUTORES VALUES (6,6,6);
INSERT INTO ALUMNOS_TUTORES VALUES (7,7,7);
INSERT INTO ALUMNOS_TUTORES VALUES (8,8,1);
INSERT INTO ALUMNOS_TUTORES VALUES (9,9,1);
INSERT INTO ALUMNOS_TUTORES VALUES (10,10,1);

SELECT * FROM TUTORES;
SELECT * FROM ALUMNOS_TUTORES;

-- ELIMINAR UNA TABLA CON TODO Y SUS DATOS
DROP TABLE ALUMNOS_TUTORES;

--CREANDO SECUENCIAS
-- Se emplea para generar valores de numeros enteros
-- Estos pueden ser consecutivos (incremento de 1)
-- o con un incremento de más valores
-- Se utiliza para generar las llaves primarias y asegurarnos
-- que los valores no se repitan

-- CREANDO UNA SECUENCIA DEFINIENDO LOS VALORES

CREATE SEQUENCE ALUMNO_SEQ -- CREAMOS LA SECUENCIA Y SU NOMBRE
START WITH 11 -- EL VALOR EN EL QUE INICIA LA SECUENCIA
INCREMENT BY 1 -- INCREMENTA EL VALOR DE LA SECUENCIA COMO SE LE INDIQUE
MAXVALUE 999 -- INDICAMOS EL VALOR MÁXIMO PARA LA SECUENCIA
MINVALUE 1 -- INDICAMOS EL VALOR MÍNIMO DE LA SECUENCIA
CYCLE; -- INDICAMOS SI LA SECUENCIA UAN VEZ LLEGADO A SU MAXIMO VALOR
-- INICIE DE NUEVO
-- SI NO INDICAMOS EN CLYCLE, POR DEFAULT LA SECUENCIA CONTINUARÍA

-- CREAR UNA SECUENCIA CON LOS VALORES POR DEFECTO

CREATE SEQUENCE ALUMNOS_TUTORES_SEQ;

-- TRIGGER (DISPARADOR) - EJECTUTAR UN ACCIÓN O DESENCADENAR UN EVENTO

show tables;

CREATE TRIGGER INSERT_ALUMNOS -- CREAMOS EL TRIGGER Y SU NOMBRE
BEFORE INSERT ON ALUMNO FOR EACH ROW BEGIN -- DONDE SE EJECUTA EL TRIGGER
SELECT ALUMNO_SEQ.NEXTVAL INTO:NEW.ID_ALUMNO FROM DUAL; --SELECCIONA EL VALOR DE LA SECUENCIA Y LO INSERTA
END;

insert into alumno values
(1, 'wiwin','30/10/1997','masculino','ASJ213','8vo ses',1);


CREATE TRIGGER INSERT_ALUMNOS_TUTORES -- CREAMOS EL TRIGGER Y SU NOMBRE
BEFORE INSERT ON ALUMNOS_TUTORES FOR EACH ROW BEGIN -- DONDE SE EJECUTA EL TRIGGER
SELECT ALUMNOS_TUTORES_SEQ.NEXTVAL INTO:NEW.ID_AT FROM DUAL; --SELECCIONA EL VALOR DE LA SECUENCIA Y LO INSERTA
END;

drop trigger inser_alumnos_tutores;
-- insercion masiva

insert all
into alumnos_tutores (id_alumno, id_tutor) values  (1,2)
into alumnos_tutores (id_alumno, id_tutor) values  (2,2)
into alumnos_tutores (id_alumno, id_tutor) values  (3,1)
into alumnos_tutores (id_alumno, id_tutor) values  (4,3)
into alumnos_tutores (id_alumno, id_tutor) values  (5,3)
select * from dual;

select * from alumnos_tutores; 


CREATE TABLE SOCIO(
ID_SOCIO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
DIRECCION NVARCHAR2 (30),
TELEFONO NVARCHAR2(10)
);

CREATE SEQUENCE SOCIO_SEQ;

CREATE TRIGGER INSERT_SOCIO
BEFORE INSERT ON SOCIO FOR EACH ROW BEGIN
SELECT SOCIO_SEQ.NEXTVAL INTO:NEW.ID_SOCIO FROM DUAL;
END;

CREATE TABLE BARCO(
ID_BARCO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
NUM_AMARRE NUMBER,
CUOTA NUMBER (6,2)
);

CREATE SEQUENCE BARCO_SEQ;

CREATE TRIGGER INSERT_BARCO
BEFORE INSERT ON BARCO FOR EACH ROW BEGIN
SELECT BARCO_SEQ.NEXTVAL INTO:NEW.ID_BARCO FROM DUAL;
END;

CREATE TABLE PATRON(
ID_PATRON NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
DIRECCION NVARCHAR2 (30),
TELEFONO NVARCHAR2(10)
);

CREATE SEQUENCE PATRON_SEQ;

CREATE TRIGGER INSERT_PATRON
BEFORE INSERT ON PATRON FOR EACH ROW BEGIN
SELECT PATRON_SEQ.NEXTVAL INTO:NEW.ID_PATRON FROM DUAL;
END;

CREATE TABLE SOCIOS_BARCO(
ID_SB NUMBER PRIMARY KEY,
ID_SOCIO NUMBER,
ID_BARCO NUMBER,
CONSTRAINT FK_ID_SOCIO
FOREIGN KEY (ID_SOCIO)
REFERENCES SOCIO (ID_SOCIO),
CONSTRAINT FK_ID_BARCO
FOREIGN KEY (ID_BARCO)
REFERENCES BARCO (ID_BARCO)
);

CREATE SEQUENCE SOCIOSBARCO_SEQ;

CREATE TRIGGER INSERT_SOCIOSBARCO
BEFORE INSERT ON SOCIOS_BARCO FOR EACH ROW BEGIN
SELECT SOCIOSBARCO_SEQ.NEXTVAL INTO:NEW.ID_SB FROM DUAL;
END;

CREATE TABLE SALIDAS_BARCO(
ID_SALIDA NUMBER PRIMARY KEY,
DESTINO NVARCHAR2(30),
FECHASALIDA DATE,
ID_BARCO NUMBER,
ID_PATRON NUMBER,
CONSTRAINT FK_IDBARCO
FOREIGN KEY (ID_BARCO)
REFERENCES BARCO (ID_BARCO),
CONSTRAINT FK_IDPATRON
FOREIGN KEY (ID_PATRON)
REFERENCES PATRON (ID_PATRON)
);

CREATE SEQUENCE SALIDASBARCO_SEQ;

CREATE TRIGGER INSERT_SALIDASBARCO
BEFORE INSERT ON SALIDAS_BARCO FOR EACH ROW BEGIN
SELECT SALIDASBARCO_SEQ.NEXTVAL INTO:NEW.ID_SALIDA FROM DUAL;
END;

DESCRIBE SOCIO;

INSERT ALL
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('AYLIN','XALAPA','2282330908')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ALEX','XALAPA','2281072635')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ALEJANDRO','CDMX','3023079497')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('EMMANUEL','CDMX','5630345103')
INTO SOCIO (NOMBRE, DIRECCION, TELEFONO)  VALUES ('EDUARDO','MORELIA','4438443145')
SELECT * FROM DUAL;

SELECT * FROM SOCIO;

INSERT ALL
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ABDIEL','XALAPA','2282535827')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('MARCOS','XALAPA','2283054341')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('TAVO','ACAPULCO','7441198412')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('AARON','XALAPA','2283443722')
INTO PATRON (NOMBRE, DIRECCION, TELEFONO)  VALUES ('CESAR','ACAPULCO','7443838589')
SELECT * FROM DUAL;

SELECT * FROM PATRON;

DESCRIBE BARCO;
INSERT ALL
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('LA NIÃA', 11, 800.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('LA PINTA', 12, 900.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('ST. MARIE', 13, 1000.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('MINI TITANIC', 14, 2000.50)
INTO BARCO (NOMBRE, NUM_AMARRE, CUOTA) VALUES ('POSEIDON', 15, 5000.50)
SELECT * FROM DUAL;

SELECT * FROM BARCO;
DESCRIBE SOCIOS_BARCO;

INSERT ALL
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (1,1)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (2,2)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (3,3)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (4,4)
INTO SOCIOS_BARCO (ID_SOCIO,ID_BARCO) VALUES (5,5)
SELECT * FROM DUAL;

SELECT * FROM SOCIOS_BARCO;

DESCRIBE SALIDAS_BARCO;
INSERT ALL
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('VERACRUZ',TO_DATE('20/01/2023 01:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON)
VALUES ('VILLAHERMOSA',TO_DATE('21/01/2023 13:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('CAMPECHE',TO_DATE('22/01/2023 14:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('YUCATAN',TO_DATE('23/01/2023 15:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('CANCUN',TO_DATE('24/01/2023 16:30:00','DD-MM-YYYY HH24:MI:SS'),1,1)
SELECT * FROM DUAL;

INSERT INTO SALIDAS_BARCO (DESTINO,FECHASALIDA,ID_BARCO,ID_PATRON) 
VALUES ('COZUMEL',TO_DATE('25/01/2023 12:00:00','DD-MM-YYYY HH24:MI:SS'),1,1);

SELECT * FROM SALIDAS_BARCO;

-- CONSULTAR HORARIO Y FECHA
SELECT ID_SALIDA,DESTINO, FECHASALIDA FROM SALIDAS_BARCO;

-- CONSULTAR UNICAMENTE HORARIO DE SALIDA
SELECT ID_SALIDA,DESTINO, TO_CHAR(FECHASALIDA, 'HH24:MI:SS') FROM SALIDAS_BARCO;

COMMIT;

--- ENTIDADES FUERTES

create table BASES(
ID_BASE number primary key,
TIPO nvarchar2(20)
);

CREATE SEQUENCE BASES_SEQ;

CREATE TRIGGER INSERT_BASES
BEFORE INSERT ON BASES FOR EACH ROW BEGIN
SELECT BASES_SEQ.NEXTVAL INTO:NEW.ID_BASE FROM DUAL;
END;

INSERT INTO BASES (TIPO) VALUES ('MANTENIMIENTO');
INSERT INTO BASES (TIPO) VALUES ('DESCANSO');
SELECT * FROM BASES;

CREATE TABLE VUELO(
ID_VUELO NUMBER PRIMARY KEY,
ORIGEN NVARCHAR2 (30),
DESTINO NVARCHAR2 (30),
HORARIOVIAJE DATE 
);

CREATE SEQUENCE VUELO_SEQ;

CREATE TRIGGER INSERT_VUELO
BEFORE INSERT ON VUELO FOR EACH ROW BEGIN
SELECT VUELO_SEQ.NEXTVAL INTO:NEW.ID_VUELO FROM DUAL;
END;

INSERT ALL 
INTO VUELO (ORIGEN,DESTINO,HORARIOVIAJE) VALUES 
('MEXICO','JAPON',TO_DATE ('20/01/2023 01:30:00', 'DD-MM-YYYY HH24:MI:SS'))
INTO VUELO (ORIGEN,DESTINO,HORARIOVIAJE) VALUES 
('CDMX','MEDELLIN',TO_DATE ('21/01/2023 02:30:00', 'DD-MM-YYYY HH24:MI:SS'))
INTO VUELO (ORIGEN,DESTINO,HORARIOVIAJE) VALUES 
('CDMX','COSTA RICA',TO_DATE ('22/01/2023 04:30:00', 'DD-MM-YYYY HH24:MI:SS'))
INTO VUELO (ORIGEN,DESTINO,HORARIOVIAJE) VALUES 
('MONTERREY','TIJUANA',TO_DATE ('23/01/2023 05:30:00', 'DD-MM-YYYY HH24:MI:SS'))
INTO VUELO (ORIGEN,DESTINO,HORARIOVIAJE) VALUES 
('PUEBLA','CANCUN',TO_DATE ('24/01/2023 06:30:00', 'DD-MM-YYYY HH24:MI:SS'))
SELECT * FROM DUAL;

SELECT * FROM VUELO;

CREATE TABLE LISTAS_CLIENTES(
ID_CLIENTE NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
TELEFONO NVARCHAR2(10),
DIRECCION NVARCHAR2(30)
);

CREATE SEQUENCE LISTAS_CLIENTES_SEQ;

CREATE TRIGGER INSERT_LISTAS_CLIENTES
BEFORE INSERT ON LISTAS_CLIENTES FOR EACH ROW BEGIN
SELECT LISTAS_CLIENTES_SEQ.NEXTVAL INTO:NEW.ID_CLIENTE FROM DUAL;
END;


INSERT ALL
INTO LISTAS_CLIENTES (NOMBRE, DIRECCION, TELEFONO)  VALUES ('AYLIN','XALAPA','2282330908')
INTO LISTAS_CLIENTES (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ALEX','XALAPA','2281072635')
INTO LISTAS_CLIENTES (NOMBRE, DIRECCION, TELEFONO)  VALUES ('ALEJANDRO','CDMX','3023079497')
INTO LISTAS_CLIENTES (NOMBRE, DIRECCION, TELEFONO)  VALUES ('EMMANUEL','CDMX','5630345103')
INTO LISTAS_CLIENTES (NOMBRE, DIRECCION, TELEFONO)  VALUES ('EDUARDO','MORELIA','4438443145')
SELECT * FROM DUAL;

SELECT * FROM LISTAS_CLIENTES;
--- ENTIDADES DEBILES

CREATE TABLE AVIONES(
ID_AVION NUMBER PRIMARY KEY,
MODELO NVARCHAR2(20),
ID_BASE NUMBER,
CONSTRAINT FK_IDBASE_AVIONES
FOREIGN KEY (ID_BASE)
REFERENCES BASES(ID_BASE),
CONSTRAINT CHECK_BASE_AVIONES CHECK (ID_BASE IN (1))
);

CREATE SEQUENCE AVIONES_SEQ;

CREATE TRIGGER INSERT_AVIONES
BEFORE INSERT ON AVIONES FOR EACH ROW BEGIN
SELECT AVIONES_SEQ.NEXTVAL INTO:NEW.ID_AVION FROM DUAL;
END;

INSERT ALL
INTO AVIONES  (MODELO,ID_BASE) VALUES ('BOEING',1)
INTO AVIONES  (MODELO,ID_BASE) VALUES ('AIRBUS',1)
INTO AVIONES  (MODELO,ID_BASE) VALUES ('JET',1)
INTO AVIONES  (MODELO,ID_BASE) VALUES ('BOEING',1)
INTO AVIONES  (MODELO,ID_BASE) VALUES ('VOLVO',1)
INTO AVIONES  (MODELO,ID_BASE) VALUES ('Embraer E-Jet',1)
SElECT * FROM DUAL;

SELECT * FROM AVIONES;

CREATE TABLE PILOTOS(
ID_PILOTO NUMBER PRIMARY KEY,
NOMBRE NVARCHAR2(30),
HORASVIAJE NUMBER,
ID_BASE NUMBER,
CONSTRAINT FK_IDBASE_PILOTOS
FOREIGN KEY (ID_BASE)
REFERENCES BASES(ID_BASE),
CONSTRAINT CHECK_BASE_PILOTOS CHECK (ID_BASE IN (2))
);

CREATE SEQUENCE PILOTOS_SEQ;

CREATE TRIGGER INSERT_PILOTOS
BEFORE INSERT ON PILOTOS FOR EACH ROW BEGIN
SELECT PILOTOS_SEQ.NEXTVAL INTO:NEW.ID_PILOTO FROM DUAL;
END;

--REGISTRO PILOTOS
INSERT ALL
INTO PILOTOS (NOMBRE,HORASVIAJE,ID_BASE) VALUES('HUGO',300,2)
INTO PILOTOS (NOMBRE,HORASVIAJE,ID_BASE) VALUES('PACO',600,2)
INTO PILOTOS (NOMBRE,HORASVIAJE,ID_BASE) VALUES('LUIS',400,2)
INTO PILOTOS (NOMBRE,HORASVIAJE,ID_BASE) VALUES('PEDRO',850,2)
INTO PILOTOS (NOMBRE,HORASVIAJE,ID_BASE) VALUES('JAIRO',330,2)
SELECT * FROM DUAL;

SELECT * FROM PILOTOS;

CREATE TABLE VUELO_AVION_PILOTO(
ID_VAP NUMBER PRIMARY KEY,
ID_VUELO NUMBER,
ID_AVION NUMBER,
ID_PILOTO NUMBER,
CONSTRAINT FK_IDVUELO_VAP
FOREIGN KEY (ID_VUELO)
REFERENCES VUELO(ID_VUELO),
CONSTRAINT FK_IDAVION_VAP
FOREIGN KEY (ID_AVION)
REFERENCES AVIONES(ID_AVION),
CONSTRAINT FK_IDPILOTO_VAP
FOREIGN KEY (ID_PILOTO)
REFERENCES PILOTOS(ID_PILOTO)
);

CREATE SEQUENCE VUELO_AVION_PILOTO_SEQ;

CREATE TRIGGER INSERT_VUELO_AVION_PILOTO
BEFORE INSERT ON VUELO_AVION_PILOTO FOR EACH ROW BEGIN
SELECT VUELO_AVION_PILOTO.NEXTVAL INTO:NEW.ID_VAP FROM DUAL;
END;

INSERT ALL 
INTO VUELO_AVION_PILOTO (ID_VUELO, ID_AVION, ID_PILOTO) VALUES (1,3,2)
INTO VUELO_AVION_PILOTO (ID_VUELO, ID_AVION, ID_PILOTO) VALUES (2,4,1)
INTO VUELO_AVION_PILOTO (ID_VUELO, ID_AVION, ID_PILOTO) VALUES (3,1,4)
INTO VUELO_AVION_PILOTO (ID_VUELO, ID_AVION, ID_PILOTO) VALUES (4,2,5)
INTO VUELO_AVION_PILOTO (ID_VUELO, ID_AVION, ID_PILOTO) VALUES (5,5,3)
SELECT * FROM DUAL;

SELECT * FROM VUELO_AVION_PILOTO;


CREATE TABLE TRIPULACION(
ID_TRIPULACION NUMBER PRIMARY KEY,
ID_NOMBRE NVARCHAR2(30),
ID_BASE  NUMBER,
CONSTRAINT FK_IDBASE_TRIPULACION
FOREIGN KEY (ID_BASE)
REFERENCES BASES(ID_BASE),
CONSTRAINT CHECK_BASE_TRIPULACION CHECK (ID_BASE IN (2))
);

CREATE SEQUENCE TRIPULACION_SEQ;

CREATE TRIGGER INSERT_TRIPULACION
BEFORE INSERT ON TRIPULACION FOR EACH ROW BEGIN
SELECT TRIPULACION_SEQ.NEXTVAL INTO:NEW.ID_TRIPULACION FROM DUAL;
END;

INSERT ALL
INTO TRIPULACION (ID_NOMBRE, ID_BASE) VALUES ('ABDIEL',2)
INTO TRIPULACION (ID_NOMBRE, ID_BASE)  VALUES ('MARCOS',2)
INTO TRIPULACION (ID_NOMBRE, ID_BASE)  VALUES ('TAVO',2)
INTO TRIPULACION (ID_NOMBRE, ID_BASE)  VALUES ('AARON',2)
INTO TRIPULACION (ID_NOMBRE, ID_BASE)  VALUES ('CESAR',2)
SELECT * FROM DUAL;

SELECT * FROM TRIPULACION;

CREATE TABLE VUELO_TRIPULACION(
ID_VT NUMBER PRIMARY KEY,
ID_VUELO NUMBER,
ID_TRIPULACION NUMBER,
CONSTRAINT FK_IDVUELO_VT
FOREIGN KEY (ID_VUELO)
REFERENCES VUELO(ID_VUELO),
CONSTRAINT FK_IDTRIPULACION_VT
FOREIGN KEY (ID_TRIPULACION)
REFERENCES TRIPULACION(ID_TRIPULACION)
);

CREATE SEQUENCE VUELO_TRIPULACION_SEQ;

CREATE TRIGGER INSERT_VUELO_TRIPULACION
BEFORE INSERT ON VUELO_TRIPULACION FOR EACH ROW BEGIN
SELECT VUELO_TRIPULACION_SEQ.NEXTVAL INTO:NEW.ID_VT FROM DUAL;
END;

INSERT ALL
INTO VUELO_TRIPULACION (ID_VUELO, ID_TRIPULACION) VALUES (1,2)
INTO VUELO_TRIPULACION (ID_VUELO, ID_TRIPULACION) VALUES (2,3)
INTO VUELO_TRIPULACION (ID_VUELO, ID_TRIPULACION) VALUES (3,4)
INTO VUELO_TRIPULACION (ID_VUELO, ID_TRIPULACION) VALUES (4,5)
INTO VUELO_TRIPULACION (ID_VUELO, ID_TRIPULACION) VALUES (5,1)
SELECT * FROM DUAL;

SELECT * FROM VUELO_TRIPULACION;


CREATE TABLE BOLETOS(
ID_VOLETO NUMBER PRIMARY KEY,
ID_VUELO NUMBER,
ID_CLIENTE NUMBER,
COSTO NUMBER (6,2),
CONSTRAINT FK_IDVUELO_BOLETOS
FOREIGN KEY (ID_VUELO)
REFERENCES VUELO (ID_VUELO),
CONSTRAINT FK_IDCLIENTE_BOLETOS
FOREIGN KEY (ID_CLIENTE)
REFERENCES LISTAS_CLIENTES(ID_CLIENTE)
);


CREATE SEQUENCE BOLETOS_SEQ;

CREATE TRIGGER INSERT_BOLETOS
BEFORE INSERT ON BOLETOS FOR EACH ROW BEGIN
SELECT BOLETOS_SEQ.NEXTVAL INTO:NEW.ID_VOLETO FROM DUAL;
END;

INSERT ALL
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (1,3,9999.99)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (2,4,8999.99)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (3,5,7599.99)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (4,1,4999.50)
INTO BOLETOS (ID_VUELO,ID_CLIENTE,COSTO) VALUES (5,2,5500)
SELECT * FROM DUAL;
SELECT * FROM BOLETOS;




INSERT INTO TRIPULACION (ID_NOMBRE, ID_BASE) VALUES ('EUGENIO',2);
SELECT * FROM TRIPULACION;
COMMIT;
--PARA REVERTIR INSERCION DE DATOS ANTES DE GUARDARLOS EL ROLLBACK NO LLEVA
--AL ULTIMO ESTADO DEL COMMIT 

INSERT INTO TRIPULACION (ID_NOMBRE, ID_BASE) VALUES ('ANTONIO',2);
SELECT * FROM TRIPULACION;

-- ELIMINAR ESPECIFICANDO EL NOMBRE DE UNA COLUMNA
DELETE FROM TRIPULACION WHERE ID_NOMBRE ='EUGENIO';
SELECT * FROM TRIPULACION;


-- MOSTRAR COLUMNAS ESPECIFICAS DE UNA TABLAS

SELECT NOMBRE FROM PILOTOS;

-- RELACIONANDO DATOS CON UNA CONDICION
SELECT HORASVIAJE, NOMBRE  FROM PILOTOS WHERE HORASVIAJE >400;

-- CONDICION AND
SELECT HORASVIAJE,NOMBRE,ID_BASE FROM PILOTOS WHERE HORASVIAJE>300 AND ID_BASE=2;

-- BETWEEN PARA BUSCAR RANGOS DE UN VALOR 
SELECT * FROM PILOTOS WHERE HORASVIAJE BETWEEN 400 AND 900;

--BUSCAR VALORE SIMILARES 
SELECT * FROM PILOTOS WHERE NOMBRE LIKE 'P%';
SELECT * FROM PILOTOS WHERE NOMBRE LIKE '%O';

-- VALOR MAXIMO Y MINIMO
SELECT MAX(HORASVIAJE) FROM PILOTOS;
SELECT MIN(HORASVIAJE) FROM PILOTOS;
SELECT * FROM PILOTOS WHERE HORASVIAJE =(SELECT MAX(HORASVIAJE) FROM PILOTOS);

COMMIT;

-- ESTABLECER COLUMNA CON VALORES NULOS
UPDATE PILOTOS SET HORASVIAJE = NULL;

SELECT * FROM PILOTOS;

ROLLBACK;
SELECT * FROM PILOTOS;

-- CONTADOR DEPENDIENDO DE UNA CONDICION 
SELECT COUNT (ID_PILOTO) FROM PILOTOS WHERE HORASVIAJE<400;

-- PROMEDIO DE HORAS VIAJE
SELECT AVG (HORASVIAJE) FROM PILOTOS;

--SUMATORIA
SELECT SUM (HORASVIAJE) FROM PILOTOS;

--FUNCIONES GROUP BY
--MOSTRAR CUANTOS ALUMNOS HAY POR CADA GENERO

SELECT COUNT (ID_ALUMNO), SEXO FROM ALUMNO GROUP BY SEXO;

-- ORDENARLOS CON EL COMANDO DESC PARA PONER EN ORDEN DESCENDENTE 
SELECT * FROM ALUMNO ORDER BY NOMBRE ASC;